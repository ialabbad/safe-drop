
// This file is automatically generated. Do not edit it directly.
import { createClient } from '@supabase/supabase-js';
import type { Database } from './custom-types';
import { createProfilesTableSql, createDriversTableSql } from './schema';

const SUPABASE_URL = "https://kdnqdigveyozsnoambph.supabase.co";
const SUPABASE_PUBLISHABLE_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImtkbnFkaWd2ZXlvenNubWJwaCIsInJvbGUiOiJhbm9uIiwiaWF0IjoxNzQ0NzMxOTgzLCJleHAiOjIwNjAzMDc5ODN9.LPSxgM8T3oWEp2FTJ0PPPGmVI04BAPDhIjUYXarjeTY";

// Import the supabase client like this:
// import { supabase } from "@/integrations/supabase/client";

export const supabase = createClient<Database>(SUPABASE_URL, SUPABASE_PUBLISHABLE_KEY);

/**
 * Call this function once to initialize the database tables if they don't exist yet.
 * You can call this in a setup script or server initialization.
 */
export async function ensureTablesExist() {
  // Use Supabase RPC or direct SQL query to create tables if missing
  // Note: Supabase client query method without rpc is experimental.
  const sqls = [createProfilesTableSql, createDriversTableSql];
  for (const sql of sqls) {
    const { error } = await supabase.rpc('query', { query: sql });
    if (error) {
      // Supabase currently doesn't allow running arbitrary SQL directly via rpc by default
      // So you might need to run this manually through Supabase SQL editor or migrate mechanism
      // This is just a placeholder to document the intent
      console.error('Error creating table:', error.message);
    }
  }
}
